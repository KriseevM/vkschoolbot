# vkschoolbot
"Школьный" бот для ВКонтакте, который может по запросу написать в ответе расписание, изменения на следующий день или домашнее задание на завтра из специальной базы данных

По поводу установки бота читайте статьи в [wiki](https://github.com/KriseevM/vkschoolbot/wiki)

Домашние задания хранятся в специальной таблице в базе данных. Каждый предмет имеет свой уникальный ID. Если ячейка с заданием по какому-либо предмету имеет значение пустой строки, то считается, что задания по предмету нет, и он не высвечивается в списке при вызове команд **"дз"** и **"всё дз"**.

ИНформация о расписании хранится в файлах в папке days и NumericDays. Названия файлов состоят из одного числа в диапазоне от 1 до 6 (1 - понедельник, 2 - вторник, 6 - суббота) В первой папке хранятся файлы с текстовым распианием (название дня недели подставляется ботом и не написано в этих файлах), во второй папке хранятся файлы с числовым распианием, в каждом из которых просто перечислен список ID предметов, которые есть в этот день (список может иметь порядок, отличающийся от реального расположения предметов в расписании, и повторяющиеся предметы можно не указывать дважды). 

Изменения в расписании хранятся в двух файлах: **changes** и **NumericChanges**. В первом файле хранится текстовая информация об изменениях в свободной форме. Во втором файле информация хранится в виде, схожем с форматом файлов в папке NumericDays, но здесь есть два дополнительных числовых значения:
* **-1** - означает, что согласно изменениям предмета, стоящего на данной строке в файле из NumericDays, не будет. Его ID удаляется из списка
* **-2** - данное значение просто пропускается и означает, что предмет, стоящий на этой строке в файле из NumericDays, не затрагивается изменениями в расписании.

Все остальные положительные значения обозначают, что предмет с соответствующей строки файла из NumericDays заменяется на предмет из файла NumericChanges. Файл NumericChanges **ВСЕГДА** содержит 8 строк.  

Можно проиллюстрировать смешение на следующем примере.

Предположим, что файл **NumericDays/1** считывается ботом и содержит следующее:

    1
    2
    3
    4
    5
    6

А файл NumericChanges содержит следующее:

    -1
    7
    -2
    -2
    8
    -1
    -2
    -2
    
Считав два данных файла и смешав их, бот получит следующий список ID предметов:

    7
    3
    4
    8
    
Именно этим списком и будет руководствоваться бот, получая список домашнего задания из базы данных.

Все данные, которые выводит бот, заполняются вручную. Однако, чтобы упростить данный процесс, у бота есть [API](https://github.com/KriseevM/vkschoolbot/wiki/API-%D0%B1%D0%BE%D1%82%D0%B0), а также специальный [веб-клиент](https://kriseevm.github.io/vkschoolbot_client/). При необходимости вы можете создать собственный клиент для работы с Вашей копией бота, основываясь на информации об API в wiki.

# Команды бота

## Расписание

Существует в двух вариациях: расписание (расписание на завтра) и расписание на сегодня. При запросе бот определяет день недели, на который нужно получить расписание, и считывает соответствующий файл из папки days, отправляя в ответе заголовок с днём недели и содержимое соответствующего файла.

## Всё расписание

> Другая вариация - **расписание на всю неделю**

Аналогично предыдущей команде, но считывается содержимое всех файлов, и выводится в форматированном виде.

## Дз

> Другие вариации - **домашка**, **домашнее задание**, **домашняя работа**, **че задали?**, **че задали**, **чо задали?**, **чо задали**, **что задали?**, **что задали**, **задание**

Отдельная вариация - **Дз на сегодня**

Бот считывает файл расписания из папки NumericDays, считывает файл NumericChanges, смешивает содержимое этих файлов в соответствии с правилами, получая список ID предметов, и считывает из базы данных задания по предметам с этими ID, и результат выводит в ответное сообщение.

## Всё дз

Бот считывает все строки из базы данных (где задание не пустое) и выводит в ответном сообщении.

## Замены

> Другая вариация - **изменения**

Выводит текст из файла changes в ответном сообщении. В файле содержится информация об изменениях в расписании.
